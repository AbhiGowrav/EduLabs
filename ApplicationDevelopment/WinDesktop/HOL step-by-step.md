# Exercise 1: Install the C# and C++ Windows App SDK extension for Visual Studio 

In this exercise, you will install the C# and C++ Windows App SDK extensions that allow you to create the applications in Visual Studio.

1. From the Virtual Machine, open the file explorer and navigate to the path `C:\LabFiles` to select the C# extension file.

1. Double click on the **WindowsAppSDK.Cs.Extension.Dev17.Standalone** file to open the VSIX installer.

   ![](./media/Extension-1.png)

1. Wait until the VSIX installer is initialized, once it is done click on **Modify** to accept the license terms and installation of pre-requisites (if any).

   ![](./media/Extension-.png)

1. Once the extension is installed, click on on the VSIX installer blade to close it.

   ![](./media/Extension-3.png)

   > Please note that the installation process takes 4-5 minutes to complete.
   
1. Navigate back to file explorer and double click on the **WindowsAppSDK.Cpp.Extension.Dev17.Standalone** file to open the VSIX installer of C++ extension.

   ![](./media/Extension-4.png)

1. Wait until the VSIX installer is initialized, once it is done click on **Modify** to accept the license terms and installation of pre-requisites (if any).

   ![](./media/Extension-5.png)

1. Once the extension is installed, click on on the VSIX installer blade to close it.

   ![](./media/Extension-6.png)
   
   > Please note that the installation process takes 4-5 minutes to complete.


# Exercise 2: Build a sample C# WinUI 3 App 

1. Go to the **Start** button in the VM, search for **Visual Studio 2022** there and select **Visual Studio 2022 Current** to open it.

   ![](./media/App1.png)

1. On the Sign in to Visual Studio click on **Sign in** and complete the Sign-in process by using the below credentials.

   ![](./media/App.png)

    * Azure Username/Email: <inject key="AzureAdUserEmail"></inject> 
    * Azure Password: <inject key="AzureAdUserPassword"></inject>

1. On the **Get Started** blade of Visual Studio, select **Create a new project** to create a new project. 

   ![](./media/App3.png)

1. On the **Create a new project** blade, select **C# (1)** under **All languages**, **Windows (2)** under **All platforms**, and **WinUI (3)** under **All project types** from the project drop-down filters.

   ![](./media/App4.png)

1. Select **Blank App, Packaged with Windows Application Packaging Project (WinUI 3 in Desktop)** template from the available project templates.

   ![](./media/App5.png)

1. Click on **Next** to enter the project details.

1. On the **Configure your new project** blade, enter the below value for **Project name (1)** field and click on **Create (2)**.

   ```
   DemoWindowsapp
   ```
   
   ![](./media/App6.png)

1. In the following dialog box, set the Target version to **Windows 10, version 2004 (build 19041) (1)** and Minimum version to **Windows 10, version 1809 (build 17763) (2)** and then click **OK (3)**.

   ![](./media/App7.png)

1. If you receive a pop-up to enable the Developer mode, toggle the Developer mode to **On** and click on **Yes** to allow installing and running apps outside of the Microsoft store.

   ![](./media/App8.1.png)
   
   ![](./media/App8.2.png)

1. Minimise the **Settings** tab and review the **project** generated by Visual Studio.

   ![](./media/App9.png)

   > Info: This project is generated only if you use the **Blank App, Packaged with Windows Application Packaging Project (WinUI 3 in Desktop)** project template. This project is a Windows Application Packaging Project that is configured to build the app into an MSIX package. This project contains the package manifest for your app, and it is the startup project for your solution by default.

1. To add a new item to your app project, right-click the **DemoWindowsapp** project node in Solution Explorer and select **Add** then **New Item**.


1. In the Add New Item dialog box, select the **WinUI** tab.

   ![](./media/App10.png)

1. Select the **Blank Page (WinUI 3) (1)**, name it as **Page1.xaml (2)** and click on **Add (3)**.

   ![](./media/App12.png)

1. Once the **Page1** is added, the file will be opened by default. Replace the existing **Grid** section with the below content.

   ```
   <Grid 
    Padding="8,8,8,8"
    HorizontalAlignment="Center">
        <Grid.RowDefinitions>
            <RowDefinition Height="auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <TextBlock
			Grid.Row="0"
			FontSize="36"
			FontWeight="Bold"
			TextAlignment="Center"
			TextWrapping="WrapWholeWords"                
			Text="Welcome to Page 1" />
        <Button 
			Grid.Row="2"
			HorizontalAlignment="Center"
			x:Name="page1Button" 
			Click="page1Button_Click">Go to Page 2</Button>
   </Grid>
   ```

1. Open the file **Page1.xaml.cs** and enter the below content after **Page1** method inside the **Page1** class to create the method.

   ```
    private void page1Button_Click(object sender, RoutedEventArgs e)
        {
            this.Frame.Navigate(typeof(Page2));
        }
    ```    

    After adding the content, your screen will look like the below screenshot.
    
    ![](./media/App14.png)
    
    > Info: The above method will navigate the current frame to Page2 when the Page1 button is clicked. You'll create a second page called Page2 and create the same layout and button click handler in the below steps. But this time navigate back to Page 1.


1. To add a second page to your app project, right-click the **DemoWindowsapp** project node in Solution Explorer and select **Add** then **New Item**.

1. In the Add New Item dialog box, select the **WinUI** tab.

1. Select the **Blank Page (WinUI 3) (1)**, name it as **Page2.xaml (2)** and click on **Add (3)**.

   ![](./media/App15.png)

1. Once the **Page2** is added, the file will be opened by default. Replace the existing **Grid** section with the below content.

   ```
   <Grid 
    Padding="8,8,8,8"
    HorizontalAlignment="Center">
        <Grid.RowDefinitions>
            <RowDefinition Height="auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="auto"/>
            <RowDefinition Height="*"/>
        </Grid.RowDefinitions>
        <TextBlock
			Grid.Row="0"
			FontSize="36"
			FontWeight="Bold"
			TextAlignment="Center"
			TextWrapping="WrapWholeWords"                
			Text="Welcome to Page 2" />
        <Button 
			Grid.Row="2"
			HorizontalAlignment="Center"
			x:Name="page2Button" 
			Click="page2Button_Click">Go to Page 1</Button>
   </Grid>
   ```

1. Open the file **Page2.xaml.cs** and enter the below content after **Page2** method inside the **Page2** class to create the method.

   ```
   private void page2Button_Click(object sender, RoutedEventArgs e)
   {
    this.Frame.Navigate(typeof(Page1));
   }
   ```
   
   After adding the content, your screen will look like the below screenshot.   
   
   ![](./media/App16.png)
    
   > Next, modify the MainWindow layout to add the frame element referenced by our pages.

   
1. Open **MainWindow.xaml** and replace the existing **StackPanel** layout with the below content that adds a simple Frame element called **mainFrame**.

   ```
   <Grid>
    <Frame x:Name="mainFrame" />
   </Grid>
   ```
   
    After adding the content, your screen will look like the below screenshot.
    
    ![](./media/App17.png)
 
1. Open **MainWindow.xaml.cs** and remove the method **myButton_Click**.

1. Finally, add the following line inside the **MainWindow** method to load Page1 into the mainFrame when the MainWindow is initialized.

    ```
    mainFrame.Navigate(typeof(Page1));
    ```    
    
    After adding the content, your screen will look like the below screenshot.   
    
    ![](./media/App18.png)
    
    

# Exercise 3: Build and run the application

1. Right-click the **DemoWindowsapp** project node in Solution Explorer and click on **Build** to build the application.

1. Once the build is succeeded, you will receive a **succeeded** message in the output window.

   ![](./media/buildapp-1.png)

1. Press **F5** or select the **green Start arrow** button on the Visual Studio toolbar to run the application.

   ![](./media/buildapp-2.png)

1. When the application is launched, Page1 will be loaded by default as you have configured the **MainWindow** method earlier to load Page1.

   ![](./media/buildapp-3.png)

1. Now, click on the **Go to Page 2** button to navigate to Page2.

   ![](./media/buildapp-4.png)

1. Next, Page2 will be loaded on the application. You can navigate back to Page1 by clicking the **Go to Page 1** button.

1. Click on **X** on the Page 2 to close the page and stop the application.


# Exercise 4: Package the application and deploy it

## Configure your project with the manifest designer

1. In Solution Explorer, expand the project node of your application project.

1. Double-click the Package.appxmanifest file. If the manifest file is already open in the XML code view, Visual Studio prompts you to close the file.

1. Select the **Packaging** tab and enter the below value in the package name field. 

   ```
   DemoWindowsapp-package
   ```

   ![](./media/packageapp-1.png)

1. Click on **File** and select **save Package.appxmanifest** to save the file.

   ![](./media/packageapp-.png)


## Generate an app package

1. In Solution Explorer, open the solution for your application project.

1. Right-click on the project and choose to **Publish** and **Create App Packages**.

1. Select **Sideloading** on the first page of the wizard and then click **Next**.

   ![](./media/packageapp-3.png)

1. On the **Select signing method** page, select **Yes, select a certificate** then **Select from File**.
 
    ![](./media/packageapp-4.1.png)

   > You can whether to skip packaging signing or select a certificate for signing. select a certificate from your local certificate store, select a certificate file, or create a new certificate. For an MSIX package to be installed on an end user's machine, it must be signed with a cert that is trusted on the machine.

1. Navigate to this path `C:\LabFiles` in the file explorer and select **UwpSigningCert.pfx**.

1. Now, enter the below password and click on **OK** to select the certificate.

    - Password: <inject key="AzureAdUserPassword"></inject>

    ![](./media/packageapp-4.2.png)

1. Click on **Next** on the Select signing method page.

    ![](./media/packageapp-4.3.png)

1. On the **Select and Configure Packages** dialog, select the architecture configurations (x86, x64) to ensure that your app can be deployed to the widest range of devices.

   ![](./media/packageapp-5.png)

1. On the **Configure update settings** blade, enter the below value in the **Installer location** field and click on **Create**.

   ```
   C:\Users\demouser\source\repos\DemoWindowsapp\
   ```

   ![](./media/packageapp-6.png)

1. Wait until the package is created. When your app has been successfully packaged, you will be presented with the below page.

   ![](./media/packageapp-7.png)


## Install app package

1. Open PowerShell ISE session and run the below command to navigate to the path that has package files.

   ```
   C:\Users\demouser\source\repos\DemoWindowsapp\DemoWindowsapp\DemoWindowsapp (Package)\AppPackages\DemoWindowsapp (Package)_1.0.2.0_Debug_Test
   ```
   
 1. Right-click on the **Add-AppDevPackage.ps1** file. Choose **Run with PowerShell**.  

